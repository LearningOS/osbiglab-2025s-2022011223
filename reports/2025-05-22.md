# 2025-05-22 汇报

## 工作进展

1. 发现游宇凡学长验证的 `memory_addr` 是[很久之前的版本](https://github.com/rcore-os/arceos/tree/dev/crates/memory_addr)，于是找到了[最新的 `memory_addr`](https://github.com/arceos-org/axmm_crates/tree/main/memory_addr)，用 Kani 验证了它。
   - 本来发现有一个 bug 会导致两个 `usize` 的变量加起来溢出，但是仔细推导了之后发现实际情况并不会发生。
      ```rust
      #[inline]
      pub const fn align_up(addr: usize, align: usize) -> usize {
          (addr + align - 1) & !(align - 1)
      }
      ```

      但还是改成了 `wrapping_add()` 的形式：

      ```rust
      #[inline]
      pub const fn align_up(addr: usize, align: usize) -> usize {
          addr.wrapping_add(align - 1) & !(align - 1)
      }
      ```
   - 然后
2. 在 `memory_addr` 中植入了 bug，例如在 `align_up` 中加入一个小错误，少写一个 `-1`：
   ```rust
   #[inline]
   pub const fn align_up(addr: usize, align: usize) -> usize {
       addr.wrapping_add(align) & !(align - 1)
   }
   ```
   
   然后 Kani 会报错：

   ```bash
   Manual Harness Summary:
   Verification failed for - addr::addr_proofs::proof_align_up
   Verification failed for - lib_proofs::proof_align_up_4k_consistency_and_properties
   Verification failed for - lib_proofs::proof_is_aligned
   Verification failed for - lib_proofs::proof_align_up_assuming_no_sum_overflow
   Complete - 51 successfully verified harnesses, 4 failures, 55 total.
   ```

## 下一周的工作

